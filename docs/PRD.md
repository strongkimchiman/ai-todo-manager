# [PRD] AI 기반 할 일 관리 웹 서비스 (AI Todo Manager)

## 1. 프로젝트 개요
사용자가 작성한 할 일을 효율적으로 관리하고, **Gemini AI**를 활용해 자연어 입력만으로 할 일을 구조화하거나 전체적인 업무 현황을 분석해주는 지능형 서비스입니다.

## 2. 주요 기능 및 요구사항

### 2.1 사용자 인증 (Supabase Auth)
- **기능:** 이메일/비밀번호 기반 로그인 및 회원가입.
- **보안:** Supabase RLS를 적용하여 본인이 생성한 `todos` 데이터만 조회/수정 가능.

### 2.2 할 일 관리 (CRUD + Realtime)
- **데이터 필드:** 제목, 설명, 우선순위(높음/중간/낮음), 카테고리, 마감일, 완료여부.
- **실시간 동기화:** **Supabase Realtime**을 활성화하여, 한 기기에서 추가/수정된 내용이 다른 기기(모바일 등)에서도 즉시 반영되도록 구현.
- **상태 관리:** 마감일이 지난 항목은 '지연' 상태로 자동 분류 UI 제공.

### 2.3 검색, 필터, 정렬
- **검색:** 제목 및 설명 내 키워드 포함 여부 검색.
- **필터:** 우선순위별, 카테고리별, 진행 상태별 필터링.
- **정렬:** 우선순위(내림차순), 마감일(임박순), 생성일(최신순).

### 2.4 AI 특화 기능 (Vercel AI SDK + Gemini)
- **AI 할 일 생성 (검증 프로세스 포함):**
  1. 사용자가 "내일 아침 10시 팀 회의" 입력.
  2. AI가 `title`, `due_date`, `priority` 등을 추출하여 JSON 반환.
  3. **UI에 '미리보기 모달' 표시 (AI가 분석한 내용 확인).**
  4. 사용자가 내용 수정 또는 "확인" 버튼 클릭 시 최종 DB 저장.
- **AI 요약/분석:**
  - **일일 요약:** 오늘 완료된 작업과 남은 고우선순위 작업 요약.
  - **주간 리포트:** 카테고리별 비중 및 완료율 분석 결과 제공.

---

## 3. 데이터 구조 및 타임존 처리

### `todos` 테이블
| 컬럼명 | 타입 | 설명 |
| :--- | :--- | :--- |
| `id` | UUID (PK) | 기본 키 (자동 생성) |
| `user_id` | UUID (FK) | `auth.users` 참조 (RLS 필수) |
| `title` | Text | 할 일 제목 |
| `description` | Text | 상세 설명 (옵션) |
| `priority` | Enum | high, medium, low |
| `category` | Text | 업무, 개인, 학습 등 |
| `due_date` | **Timestamptz** | **마감 기한 (UTC 기준 저장)** |
| `is_completed` | Boolean | 완료 여부 (기본값: false) |
| `created_at` | **Timestamptz** | 생성일 (기본값: now()) |

### 🛠️ 핵심 로직: 타임존(Timezone) 처리
- **저장 시:** 클라이언트에서 날짜를 선택하거나 AI가 날짜를 생성할 때, 반드시 **UTC 포맷**으로 변환하여 DB에 저장합니다.
- **조회 시:** 서버에서 받은 UTC 시간을 클라이언트의 브라우저 로컬 타임존으로 변환하여 사용자에게 보여줍니다.
- **AI 연동 시:** 프롬프트에 `Current User Time: YYYY-MM-DD HH:mm` 정보를 함께 주입하여, AI가 "내일"을 정확한 날짜로 계산하도록 합니다.

---

## 4. UI/UX 화면 구성

### 4.1 인증 화면 (`/login`, `/signup`)
- 간단한 카드 형태의 폼.
- 에러 발생 시 한글 메시지 노출 (예: "이미 등록된 이메일입니다.").

### 4.2 메인 대시보드 (`/dashboard`)
- **실시간 리스트:** Realtime 구독을 통해 변경 사항이 실시간으로 애니메이션과 함께 반영됨.
- **AI 입력바:** 하단 또는 상단에 위치. 입력 후 **'생성 미리보기 모달'** 팝업.
- **필터/정렬:** 사이드바 또는 상단 헤더에 배치.

### 4.3 통계 화면 (`/stats` - 확장 예정)
- 주간 활동량 및 카테고리 통계 시각화.

---

## 5. 기술 스택 (확정)
- **Framework:** Next.js 15 (App Router)
- **Styles:** Tailwind CSS, shadcn/ui
- **Backend:** Supabase (Auth, DB, **Realtime**)
- **AI:** Vercel AI SDK + Google Gemini
- **Time:** `date-fns` 또는 `dayjs` (타임존 처리용)